
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="description" content="DRIS Workflows">
		<meta name="keywords" content="node-dri,node-fedora,tchpc,dri,dris-workflows,howest">
		<title>DRIS Workflows DRIS Workflows</title>
		<script type="text/javascript">var _sf_startpt = (new Date()).getTime()</script>
		<link rel="stylesheet" href="/css/bootstrap.css" type="text/css" media="all">
	</head>
	<div class="navbar">
		<div class="navbar-inner">
			<div class="container-fluid">
				<a class="brand" href="#">DRIS</a>
				<ul class="nav">
					<li>
						<a href="/">Home</a>
					</li>
					<li>
						<a href="/contact">Contact</a>
					</li>
					<li>
						<a href="all-pages">All Pages</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
	<div class="container-fluid">
		<div class="row-fluid">
			<div class="span12">
				<div class="span9">
					<article class="article">
						<div class="metadata">
							<h1><span class="title"><a href=".">DRIS Workflows</a></span><small> <span class="about">by <strong class="author"> <span class="name">Jimmy Tang</span> <span class="github"></span> </strong> </span> <span class="about"> on <em><time class="date">Thursday, Mar 29 2012</time></em></span> </small></h1>
							<div class="breadcrumbs">
								@: / <a href="" class="breadcrumb"></a>
							</div>
						</div>
						<div class="content"><p>The DRIS Workflows package is a prototype system developed by some interns at TCHPC during the 2012 internship.

</p>
<h2>Primary authors of DRIS Workflows</h2>
<ul>
<li><a href="mailto:Matthias.Van.Wambeke@howest.be">Matthias.Van.Wambeke@howest.be</a></li>
<li><a href="mailto:Quirijn.Groot.Bluemink@howest.be">Quirijn.Groot.Bluemink@howest.be</a>

</li>
</ul>
<p>With input from the TCHPC and DRIS team at TCD.

</p>
<h2>Architecture</h2>
<p>The DRIS Workflows application consists of a number of components,
there are some planned features which have yet to be implemented.

</p>
<ul>
<li>dri-api (REST API server)<ul>
<li>node-dri (Back-office operations)<ul>
<li>node-fedora (Fedora-commons interface, planned on turning this
into a plugin)</li>
</ul>
</li>
</ul>
</li>
<li>dri-auth (oauth2 provider, planned)</li>
</ul>
<h3>Overview of current Architecture</h3>
<p><img src="/img/HighLevelArch-mvanwamb-qgrootbl-jtang-2012-04-13-dris-workflows.png" alt="">

</p>
<p>The architecture of the system is in an unstable state as we test the
design of the object model.

</p>
<h2>Licensing</h2>
<p>TBD - ultimately GPLv2 or MIT based license?

</p>
<h2>Requirements</h2>
<p>The pre-requisites for installing the DRIS Workflows package.

</p>
<ul>
<li>Nodejs 0.6.x - <a href="http://www.nodejs.org">http://www.nodejs.org</a> - developed with</li>
<li>Mongodb 2.0.x - <a href="http://www.mongodb.org">http://www.mongodb.org</a> - developed with</li>
<li>fedora-commons 3.5 - <a href="http://fedora-commons.org/">http://fedora-commons.org/</a> - tested against REST api</li>
</ul>
<p>The systems that we have tested on

</p>
<ul>
<li>Tested on OSX 10.6.x, 10.7.x, SL6.x, Windows 7</li>
<li>Browsers tested with Chrome</li>
</ul>
<h2>Installation</h2>
<p>Currently the DRIS Workflows web-application depends on some internal
servers in TCHPC, this is required to pull the latest development versions
of dri-api, node-fedora, node-dri.

</p>
<p>If you are on a VPN to TCHPC or TCD it is possible to do the following to
install the API server and the Web application.

</p>
<h3>Deployment of API server (Required)</h3>
<pre><code><span class="identifier">git</span> <span class="identifier"><span class="keymethods">clone</span></span> <span class="identifier">ssh</span><span class="symbol">:</span>/<span class="regexp">/git@howest-server.tchpc.tcd.ie/howest</span><span class="regexp">/node/dri</span>-<span class="identifier">api</span>.<span class="identifier">git</span>
<span class="identifier">cd</span> <span class="identifier">dri</span>-<span class="identifier">api</span>
<span class="identifier">npm</span> <span class="identifier">install</span></code></pre>
<p>Once the <em>dri-api</em> server is installed with its dependancies, it must
be started by doing the following.

</p>
<pre><code>node app.js</code></pre>
<p>The fedora configuration needs to be refactored in the future, to
configure the target fedora repository the administrator needs to edit
<em>node_modules/fedora/lib/fedora.js</em>.

</p>
<h3>Deployment of DRIS Workflows (Required)</h3>
<pre><code><span class="identifier">git</span> <span class="identifier"><span class="keymethods">clone</span></span> <span class="identifier">ssh</span><span class="symbol">:</span>/<span class="regexp">/git@howest-server.tchpc.tcd.ie/howest</span><span class="regexp">/node/dris</span>-<span class="identifier">workflows</span>.<span class="identifier">git</span>
<span class="identifier">cd</span> <span class="identifier">dris</span>-<span class="identifier">workflows</span>
<span class="identifier">npm</span> <span class="identifier">install</span></code></pre>
<p>Once the <em>dris-workflow</em> application is installed with its dependancies, it must
be started by doing the following.

</p>
<pre><code>node app.js</code></pre>
<h2>Testing</h2>
<p>The intent is to release a set of API tests which can be used as a basis
for DRIS (DRI) compliance testing for those who wish to implement or
re-implement a compatible system.

</p>
<p>The tests are written with the <a href="http://visionmedia.github.com/mocha/">mocha</a> test framework.
The DRIS Workflows and dependent packages have tests which can be run as follows

</p>
<h3>Linux and OSX</h3>
<pre><code><span class="identifier">cd</span> <span class="constant">PACKAGE</span>
<span class="identifier">make</span> <span class="identifier"><span class="keymethods">test</span></span></code></pre>
<h3>Windows</h3>
<pre><code><span class="identifier">cd</span> <span class="constant">PACKAGE</span>
<span class="constant">NODE_PATH</span>=.<span class="regexp">/lib NODE_ENV=test ./node</span><span class="identifier">_modules</span>/.<span class="identifier">bin</span>/<span class="identifier">mocha</span> \
--<span class="identifier">reporter</span> <span class="identifier">spec</span> \
<span class="identifier"><span class="keymethods">test</span></span>/*.<span class="identifier">js</span></code></pre>
<h2>mrconfig</h2>
<p>If you are using <a href="http://joey.kitenet.net/code/mr/">mr</a>, the following
config file can be used to checkout all the relavent packages.

</p>
<pre><code>[dri-api]
checkout = git clone 'ssh:<span class="comment">//g</span>it@lonsdale.tchpc.tcd.ie/navr/node/dri-api' 'dri-api'

[dris-workflows]
checkout = git clone 'ssh:<span class="comment">//g</span>it@lonsdale.tchpc.tcd.ie/navr/node/dris-workflows' 'dris-workflows'

[dris-workflows-site]
checkout = git clone 'ssh:<span class="comment">//g</span>it@lonsdale.tchpc.tcd.ie/navr/node/dris-workflows-site' 'dris-workflows-site'

[node-dri]
checkout = git clone 'ssh:<span class="comment">//g</span>it@lonsdale.tchpc.tcd.ie/navr/node/node-dri' 'node-dri'

[node-fedora]
checkout = git clone 'ssh:<span class="comment">//g</span>it@lonsdale.tchpc.tcd.ie/navr/node/node-fedora' 'node-fedora'</code></pre>
<h2>Apache deployment</h2>
<p>Sample apache deployment, this assumes that dri-api and dris-workflows are CNAMES for dri-devel where the applications are being run.

</p>
<pre><code>&lt;Proxy *&gt;
Order deny,allow
Allow from all
&lt;/Proxy&gt;

<span class="comment"># api server</span>
&lt;VirtualHost <span class="number">134.226</span>.<span class="number">115.72</span>:<span class="number">80</span>&gt;
    ServerName              dri-api.tchpc.tcd.ie
    ProxyPass /             http:<span class="comment">//d</span>ri-api.tchpc.tcd.ie:<span class="number">4000</span>/
    ProxyPassReverse /      http:<span class="comment">//d</span>ri-api.tchpc.tcd.ie:<span class="number">4000</span>/
&lt;/VirtualHost&gt;

<span class="comment"># web application</span>
&lt;VirtualHost <span class="number">134.226</span>.<span class="number">115.72</span>:<span class="number">80</span>&gt;
    ServerName              dris-workflows.tchpc.tcd.ie
    ProxyPass /             http:<span class="comment">//d</span>ris-workflows.tchpc.tcd.ie:<span class="number">3000</span>/
    ProxyPassReverse /      http:<span class="comment">//d</span>ris-workflows.tchpc.tcd.ie:<span class="number">3000</span>/
&lt;/VirtualHost&gt;</code></pre>
</div>
					</article>
				</div>
				<div class="span3">
					<nav id="toc"><ul><li><a href="/contact">contact</a></li><li><a href="/api-for-dri-api">api for dri api</a></li><li><a href="/api-for-node-fedora">api for node fedora</a></li><li><a href="/api-for-node-dri">api for node dri</a></li><li><a href="/all-pages">all pages</a></li></ul></nav>
				</div>
			</div>
		</div>
		<footer id="footer">
			<hr>
			<p>
				<a href="/">DRIS Workflows</a> documentation site powered by <a href="https://github.com/flatiron/blacksmith">Blacksmith</a> / styled with <a href="http://twitter.github.com/bootstrap/">twitter bootstrap</a>
			</p>
		</footer>
	</div>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
	<script>
		$(document).ready(function() {
			$('#toc ul').addClass('nav nav-list');
			$('#toc ul').prepend('<li class="nav-header">Table of contents</li>')
			$('.breadcrumb').removeClass('breadcrumb')
		})
	</script>
</html>
